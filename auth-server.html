<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>Server Setup | Melody Auth</title><meta name="description" content="Effortless OAuth and Authentication, Built for Flexibility and Control.">
    <link rel="preload" href="/assets/style-pqpGs7N-.css" as="style"><link rel="stylesheet" href="/assets/style-pqpGs7N-.css">
    <link rel="modulepreload" href="/assets/app-DpbDqZoo.js"><link rel="modulepreload" href="/assets/auth-server.html-CRBPQdB8.js">
    <link rel="prefetch" href="/assets/index.html-ChVko_Co.js" as="script"><link rel="prefetch" href="/assets/admin-panel.html-CKp35ZLQ.js" as="script"><link rel="prefetch" href="/assets/q_a.html-CgDtl-pY.js" as="script"><link rel="prefetch" href="/assets/react-sdk.html-BwsJoYVp.js" as="script"><link rel="prefetch" href="/assets/s2s-api.html-B20RYO5d.js" as="script"><link rel="prefetch" href="/assets/screenshots.html-CPqVI-Sd.js" as="script"><link rel="prefetch" href="/assets/404.html-f3i9EmJT.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://raw.githubusercontent.com/ValueMelody/melody-homepage/main/logo.jpg" alt="Melody Auth"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Melody Auth</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><!----><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Server Setup <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="server-setup" tabindex="-1"><a class="header-anchor" href="#server-setup"><span>Server Setup</span></a></h1><h2 id="environment-setup-cloudflare" tabindex="-1"><a class="header-anchor" href="#environment-setup-cloudflare"><span>Environment Setup (Cloudflare)</span></a></h2><h3 id="_1-cloudflare-account-setup" tabindex="-1"><a class="header-anchor" href="#_1-cloudflare-account-setup"><span>1. Cloudflare Account Setup</span></a></h3><ol><li>Sign up for a Cloudflare account if you don&#39;t have one already.</li><li>Install Wrangler CLI and authenticate:</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">npx wrangler</span>
<span class="line">wrangler login</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-cloudflare-resource-creation" tabindex="-1"><a class="header-anchor" href="#_2-cloudflare-resource-creation"><span>2. Cloudflare Resource Creation</span></a></h3><p>Go to Cloudflare dashboard</p><ol><li>Create a Worker:</li></ol><ul><li>Go to Workers &amp; Pages -&gt; Overview -&gt; Click &quot;Create&quot; button</li><li>Name the worker &quot;melody-auth&quot;</li><li>After creation, go to the worker settings -&gt; Variables</li><li>Add a variable named &quot;AUTH_SERVER_URL&quot; with the value set to your worker&#39;s URL (e.g., https://melody-auth.[your-account-name].workers.dev)</li></ul><ol start="2"><li>Create a D1 database:</li></ol><ul><li>Go to Workers &amp; Pages -&gt; D1 -&gt; Click &quot;Create database&quot; button</li></ul><ol start="3"><li>Create a KV namespace:</li></ol><ul><li>Go to Workers &amp; Pages -&gt; KV -&gt; Click &quot;Create a namespace&quot; button</li></ul><h3 id="_3-project-setup" tabindex="-1"><a class="header-anchor" href="#_3-project-setup"><span>3. Project Setup</span></a></h3><ol><li>Clone the repository:</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">git clone git@github.com:ValueMelody/melody-auth.git</span>
<span class="line">cd melody-auth</span>
<span class="line">npm install</span>
<span class="line">npm run build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Update <code>server/wrangler.toml</code>: Replace the KV id and D1 id with your newly created resources:</li></ol><div class="language-toml line-numbers-mode" data-highlighter="prismjs" data-ext="toml" data-title="toml"><pre class="language-toml"><code><span class="line"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token table class-name">kv_namespaces</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token key property">binding</span> <span class="token punctuation">=</span> <span class="token string">&quot;KV&quot;</span></span>
<span class="line"><span class="token key property">id</span> <span class="token punctuation">=</span> <span class="token string">&quot;your_kv_namespace_id&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token table class-name">d1_databases</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token key property">binding</span> <span class="token punctuation">=</span> <span class="token string">&quot;DB&quot;</span></span>
<span class="line"><span class="token key property">database_name</span> <span class="token punctuation">=</span> <span class="token string">&quot;melody-auth&quot;</span></span>
<span class="line"><span class="token key property">database_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;your_d1_database_id&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-deploy" tabindex="-1"><a class="header-anchor" href="#_4-deploy"><span>4. Deploy</span></a></h3><p>Run the following commands to set up your remote D1, KV, and deploy the code to your Worker:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">cd server</span>
<span class="line">npm run prod:secret:generate</span>
<span class="line">npm run prod:migration:apply</span>
<span class="line">npm run prod:deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now you are all set, you can verify your server by accessing: <code>[your_worker_url]/.well-known/openid-configuration</code></p><h3 id="cloudflare-local-development" tabindex="-1"><a class="header-anchor" href="#cloudflare-local-development"><span>Cloudflare Local development</span></a></h3><p>To set up your local development environment, follow these steps:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">git clone git@github.com:ValueMelody/melody-auth.git</span>
<span class="line">cd melody-auth</span>
<span class="line">npm install</span>
<span class="line">npm run build</span>
<span class="line"></span>
<span class="line">cd server</span>
<span class="line">cp .dev.vars.example .dev.vars</span>
<span class="line"># Configure your email-related environment variables in .dev.vars</span>
<span class="line">npm run dev:secret:generate</span>
<span class="line">npm run dev:migration:apply</span>
<span class="line">npm run dev:start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="environment-setup-node" tabindex="-1"><a class="header-anchor" href="#environment-setup-node"><span>Environment Setup (Node)</span></a></h2><h3 id="_1-node-postgres-and-redis-setup" tabindex="-1"><a class="header-anchor" href="#_1-node-postgres-and-redis-setup"><span>1. Node, Postgres and Redis setup</span></a></h3><p>Begin by setting up your PostgreSQL and Redis servers, and ensure you have the connection strings ready for integration. Please also ensure you are using <b>Node.js version 20.05 or higher</b> for compatibility.</p><h3 id="_2-project-setup" tabindex="-1"><a class="header-anchor" href="#_2-project-setup"><span>2. Project setup</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">git clone git@github.com:ValueMelody/melody-auth.git</span>
<span class="line">cd melody-auth</span>
<span class="line">npm install</span>
<span class="line">npm run build</span>
<span class="line"></span>
<span class="line">cd server</span>
<span class="line">cp .dev.vars.example .dev.vars</span>
<span class="line"># Add your PostgreSQL and Redis connection strings to .dev.vars</span>
<span class="line"># Configure your email-related environment variables in .dev.vars</span>
<span class="line">npm run node:secret:generate</span>
<span class="line">npm run node:migration:apply</span>
<span class="line">npm run node:dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-production-build" tabindex="-1"><a class="header-anchor" href="#_3-production-build"><span>3. Production Build</span></a></h3><p>Run the following commands to build and start the server:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">cd server</span>
<span class="line">npm run node:build</span>
<span class="line">npm run node:start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="mailer-setup" tabindex="-1"><a class="header-anchor" href="#mailer-setup"><span>Mailer Setup</span></a></h2><p>Melody Auth supports email-based features such as password reset, email verification, and email MFA. To ensure these features work as expected, you need to configure either SendGrid, Brevo, or SMTP integration.</p><ul><li>For Cloudflare Workers or Node Version: SendGrid and Brevo integration are supported.</li><li>For the Node version only: You can use an SMTP server.</li></ul><h3 id="configuration-steps-cloudflare-production" tabindex="-1"><a class="header-anchor" href="#configuration-steps-cloudflare-production"><span>Configuration Steps (Cloudflare Production)</span></a></h3><ol><li><p>Navigate to the Cloudflare dashboard:</p><ul><li>Go to Workers &amp; Pages</li><li>Select your Melody Auth worker</li><li>Click on &quot;Settings&quot; -&gt; &quot;Variables&quot;</li></ul></li><li><p>Add the following environment variables:</p><table><thead><tr><th>Variable Name</th><th>Description</th><th>Example Value</th></tr></thead><tbody><tr><td>ENVIRONMENT</td><td>Determines the email sending behavior</td><td>&quot;prod&quot; or &quot;dev&quot;</td></tr><tr><td>DEV_EMAIL_RECEIVER</td><td>Email address for testing (used when ENVIRONMENT is not &#39;prod&#39;)</td><td>&quot;test@example.com&quot;</td></tr><tr><td>SENDGRID_API_KEY</td><td>Your SendGrid API key (not needed if you intend to use Mailgun or Brevo)</td><td>&quot;SG.xxxxxxxxxxxxxxxxxxxxxxxx&quot;</td></tr><tr><td>SENDGRID_SENDER_ADDRESS</td><td>Your verified sender email address in SendGrid (not needed if you intend to use Mailgun or Brevo)</td><td>&quot;noreply@yourdomain.com&quot;</td></tr><tr><td>MAILGUN_API_KEY</td><td>Your Mailgun API key (not needed if you intend to use SendGrid or Brevo)</td><td>&quot;xxxxxxxxxxxxxxxxxx-xxxxxxxxx&quot;</td></tr><tr><td>MAILGUN_SENDER_ADDRESS</td><td>Your sender email address in Mailgun (not needed if you intend to use SendGrid or Brevo)</td><td>&quot;noreply@yourdomain.com&quot;</td></tr><tr><td>BREVO_API_KEY</td><td>Your Brevo API key (not needed if you intend to use SendGrid or Mailgun)</td><td>&quot;xkeysib-.xxxxxxxxxxxxxxxxxxxxxxxx&quot;</td></tr><tr><td>BREVO_SENDER_ADDRESS</td><td>Your verified sender email address in Brevo (not needed if you intend to use SendGrid or Mailgun)</td><td>&quot;noreply@yourdomain.com&quot;</td></tr></tbody></table></li><li><p>Click &quot;Save and deploy&quot; to apply the changes.</p></li></ol><h3 id="configuration-steps-cloudflare-local-or-node" tabindex="-1"><a class="header-anchor" href="#configuration-steps-cloudflare-local-or-node"><span>Configuration Steps (Cloudflare Local or Node)</span></a></h3><p>Update the following environment variables in your server/.dev.vars file:<br> • ENVIRONMENT<br> • DEV_EMAIL_RECEIVER<br> • SENDGRID_API_KEY<br> • SENDGRID_SENDER_ADDRESS<br> • MAILGUN_API_KEY<br> • MAILGUN_SENDER_ADDRESS • BREVO_API_KEY<br> • BREVO_SENDER_ADDRESS</p><h3 id="configuration-steps-smtp-with-node" tabindex="-1"><a class="header-anchor" href="#configuration-steps-smtp-with-node"><span>Configuration Steps (SMTP with Node)</span></a></h3><p>If you are using the Node version, you can configure the following environment variables in your server/.dev.vars file to use an SMTP server:<br> • SMTP_SENDER_ADDRESS<br> • SMTP_CONNECTION_STRING</p><h3 id="mailer-environment-behavior" tabindex="-1"><a class="header-anchor" href="#mailer-environment-behavior"><span>Mailer Environment Behavior</span></a></h3><ul><li><p>When <code>ENVIRONMENT</code> is set to &quot;prod&quot;:</p><ul><li>Emails will be sent to the actual user email addresses.</li><li>Use this setting for production deployments.</li></ul></li><li><p>When <code>ENVIRONMENT</code> is not set to &quot;prod&quot; (e.g., set to &quot;dev&quot;):</p><ul><li>All emails will be redirected to the address specified in <code>DEV_EMAIL_RECEIVER</code>.</li><li>This is useful for testing and development to avoid sending emails to real users.</li></ul></li><li><p>Priority Between SendGrid, Brevo and SMTP server:</p><ul><li>For node version, If SMTP_CONNECTION_STRING is defined, the SMTP server will always be used, regardless of SendGrid or Brevo settings.</li><li>For Cloudflare (both prod and dev): SMTP_CONNECTION_STRING will be ignored.</li><li>If both SendGrid and Brevo keys and sender addresses are provided, SendGrid will take precedence.</li></ul></li></ul><h2 id="sms-setup" tabindex="-1"><a class="header-anchor" href="#sms-setup"><span>SMS Setup</span></a></h2><p>Melody Auth supports SMS MFA. To ensure this feature work as expected, you need to configure Twilio integration.</p><h3 id="configuration-steps-cloudflare-production-1" tabindex="-1"><a class="header-anchor" href="#configuration-steps-cloudflare-production-1"><span>Configuration Steps (Cloudflare Production)</span></a></h3><ol><li><p>Navigate to the Cloudflare dashboard:</p><ul><li>Go to Workers &amp; Pages</li><li>Select your Melody Auth worker</li><li>Click on &quot;Settings&quot; -&gt; &quot;Variables&quot;</li></ul></li><li><p>Add the following environment variables:</p><table><thead><tr><th>Variable Name</th><th>Description</th><th>Example Value</th></tr></thead><tbody><tr><td>ENVIRONMENT</td><td>Determines the sms sending behavior</td><td>&quot;prod&quot; or &quot;dev&quot;</td></tr><tr><td>DEV_SMS_RECEIVER</td><td>Phone number for testing (used when ENVIRONMENT is not &#39;prod&#39;)</td><td>&quot;+16471231234&quot;</td></tr><tr><td>TWILIO_ACCOUNT_ID</td><td>Your Twilio account id</td><td></td></tr><tr><td>TWILIO_AUTH_TOKEN</td><td>Your Twilio auth token</td><td></td></tr><tr><td>TWILIO_SENDER_NUMBER</td><td>Your Twilio sender number</td><td></td></tr></tbody></table></li><li><p>Click &quot;Save and deploy&quot; to apply the changes.</p></li></ol><h3 id="configuration-steps-cloudflare-local-or-node-1" tabindex="-1"><a class="header-anchor" href="#configuration-steps-cloudflare-local-or-node-1"><span>Configuration Steps (Cloudflare Local or Node)</span></a></h3><p>Update the following environment variables in your server/.dev.vars file:<br> • ENVIRONMENT<br> • DEV_SMS_RECEIVER<br> • TWILIO_ACCOUNT_ID<br> • TWILIO_AUTH_TOKEN<br> • TWILIO_SENDER_NUMBER</p><h3 id="sms-environment-behavior" tabindex="-1"><a class="header-anchor" href="#sms-environment-behavior"><span>SMS Environment Behavior</span></a></h3><ul><li><p>When <code>ENVIRONMENT</code> is set to &quot;prod&quot;:</p><ul><li>Messages will be sent to the actual user phone number.</li><li>Use this setting for production deployments.</li></ul></li><li><p>When <code>ENVIRONMENT</code> is not set to &quot;prod&quot; (e.g., set to &quot;dev&quot;):</p><ul><li>All messages will be redirected to the phone number specified in <code>DEV_SMS_RECEIVER</code>.</li><li>This is useful for testing and development to avoid sending messages to real users.</li></ul></li></ul><h2 id="additional-configs" tabindex="-1"><a class="header-anchor" href="#additional-configs"><span>Additional Configs</span></a></h2><p>Melody Auth offers a range of customizable options to tailor the server to your specific needs. You can modify these settings by adjusting the values in the <code>[vars]</code> section of the <code>server/wrangler.toml</code> file.</p><p>To apply your changes:</p><ol><li>Open <code>server/wrangler.toml</code> in your preferred text editor.</li><li>Locate the <code>[vars]</code> section.</li><li>Modify the values as needed.</li><li>Save the file.</li><li>Redeploy your server using the command:</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">cd server</span>
<span class="line">npm run prod:deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="authorization-code-expires-in" tabindex="-1"><a class="header-anchor" href="#authorization-code-expires-in"><span>AUTHORIZATION_CODE_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 300 (5 minutes)</li><li><strong>Description:</strong> Determines how long the authorization code is valid before it expires.</li></ul><h3 id="spa-access-token-expires-in" tabindex="-1"><a class="header-anchor" href="#spa-access-token-expires-in"><span>SPA_ACCESS_TOKEN_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 1800 (30 minutes)</li><li><strong>Description:</strong> Determines how long the access token granted for single page applications is valid before it expires.</li></ul><h3 id="spa-refresh-token-expires-in" tabindex="-1"><a class="header-anchor" href="#spa-refresh-token-expires-in"><span>SPA_REFRESH_TOKEN_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 604800 (7 days)</li><li><strong>Description:</strong> Determines how long the refresh token granted for single page applications is valid before it expires.</li></ul><h3 id="s2s-access-token-expires-in" tabindex="-1"><a class="header-anchor" href="#s2s-access-token-expires-in"><span>S2S_ACCESS_TOKEN_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 3600 (1 hour)</li><li><strong>Description:</strong> Determines how long the access token granted for server-to-server applications is valid before it expires.</li></ul><h3 id="id-token-expires-in" tabindex="-1"><a class="header-anchor" href="#id-token-expires-in"><span>ID_TOKEN_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 1800 (30 minutes)</li><li><strong>Description:</strong> Determines how long the ID token is valid before it expires.</li></ul><h3 id="server-session-expires-in" tabindex="-1"><a class="header-anchor" href="#server-session-expires-in"><span>SERVER_SESSION_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 1800 (30 minutes)</li><li><strong>Description:</strong> Determines how long the server session is valid before it expires. If set to 0, the server session will be disabled.</li></ul><h3 id="company-logo-url" tabindex="-1"><a class="header-anchor" href="#company-logo-url"><span>COMPANY_LOGO_URL</span></a></h3><ul><li><strong>Default:</strong> https://raw.githubusercontent.com/ValueMelody/melody-homepage/main/logo.jpg</li><li><strong>Description:</strong> The logo used for branding.</li></ul><h3 id="email-sender-name" tabindex="-1"><a class="header-anchor" href="#email-sender-name"><span>EMAIL_SENDER_NAME</span></a></h3><ul><li><strong>Default:</strong> &quot;Melody Auth&quot;</li><li><strong>Description:</strong> The sender name that appears in emails.</li></ul><h3 id="google-auth-client-id" tabindex="-1"><a class="header-anchor" href="#google-auth-client-id"><span>GOOGLE_AUTH_CLIENT_ID</span></a></h3><ul><li><strong>Default:</strong> &quot;&quot;</li><li><strong>Description:</strong> The Google Authentication Client ID is required to enable the Google Sign-In function. This ID is obtained from the Google Developer Console and uniquely identifies your application to Google. If this value is left empty, the Google Sign-In button will be suppressed and the Google sign-in functionality will not be available.</li></ul><h3 id="facebook-auth-client-id" tabindex="-1"><a class="header-anchor" href="#facebook-auth-client-id"><span>FACEBOOK_AUTH_CLIENT_ID</span></a></h3><ul><li><strong>Default:</strong> &quot;&quot;</li><li><strong>Description:</strong> The Facebook Authentication Client ID is required to enable the Facebook Sign-In function. This ID is obtained from the Facebook Developer Console and uniquely identifies your application to Facebook. If this value is left empty, the Facebook Sign-In button will be suppressed and the Facebook sign-in functionality will not be available. <b>You also need to set FACEBOOK_AUTH_CLIENT_SECRET in .dev.vars for Cloudflare dev env as well as Node env, and in Cloudflare workers config for Cloudflare prod env.</b></li></ul><h3 id="github-auth-client-id-github-auth-app-name" tabindex="-1"><a class="header-anchor" href="#github-auth-client-id-github-auth-app-name"><span>GITHUB_AUTH_CLIENT_ID &amp; GITHUB_AUTH_APP_NAME</span></a></h3><ul><li><strong>Default:</strong> &quot;&quot;</li><li><strong>Description:</strong> The GitHub Authentication Client ID and App Name is required to enable the GitHub Sign-In function. This Client ID and App Name is obtained from the GitHub Developer Console and uniquely identifies your application to GitHub. If this value is left empty, the GitHub Sign-In button will be suppressed and the GitHub sign-in functionality will not be available. <b>You also need to set GITHUB_AUTH_CLIENT_SECRET in .dev.vars for Cloudflare dev env as well as Node env, and in Cloudflare workers config for Cloudflare prod env. In your GitHub App settings, set the callback URL to [your auth server doamin]/identity/v1/authorize-github, e.g., http://localhost:8787/identity/v1/authorize-github</b></li></ul><h3 id="enable-sign-up" tabindex="-1"><a class="header-anchor" href="#enable-sign-up"><span>ENABLE_SIGN_UP</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Determines if user sign-up is allowed. If set to false, the sign-up button will be suppressed on the sign-in page.</li></ul><h3 id="enable-password-sign-in" tabindex="-1"><a class="header-anchor" href="#enable-password-sign-in"><span>ENABLE_PASSWORD_SIGN_IN</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Determines if password sign-in is allowed. If you only want to support social sign-in, you can set ENABLE_SIGN_UP, ENABLE_PASSWORD_SIGN_IN and ENABLE_PASSWORD_RESET to false.</li></ul><h3 id="enable-password-reset" tabindex="-1"><a class="header-anchor" href="#enable-password-reset"><span>ENABLE_PASSWORD_RESET</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Determines if user password reset is allowed. If set to false, the reset password button will be suppressed on the sign-in page. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="password-reset-email-threshold" tabindex="-1"><a class="header-anchor" href="#password-reset-email-threshold"><span>PASSWORD_RESET_EMAIL_THRESHOLD</span></a></h3><ul><li><strong>Default:</strong> 5</li><li><strong>Description:</strong> Limits the number of password reset email requests allowed per email and IP address per day to protect against abuse.</li></ul><h3 id="enable-names" tabindex="-1"><a class="header-anchor" href="#enable-names"><span>ENABLE_NAMES</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Provides fields for users to enter their first and last names during sign-up. If set to false, the first and last name fields will not show up on the sign-up page.</li></ul><h3 id="names-is-required" tabindex="-1"><a class="header-anchor" href="#names-is-required"><span>NAMES_IS_REQUIRED</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Determines if users are required to provide their first and last names during sign-up.</li></ul><h3 id="enable-user-app-consent" tabindex="-1"><a class="header-anchor" href="#enable-user-app-consent"><span>ENABLE_USER_APP_CONSENT</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Requires users to consent to grant access to each app after authentication.</li></ul><h3 id="enable-email-verification" tabindex="-1"><a class="header-anchor" href="#enable-email-verification"><span>ENABLE_EMAIL_VERIFICATION</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> If set to true, users will receive an email to verify their email address after signing up. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="otp-mfa-is-required" tabindex="-1"><a class="header-anchor" href="#otp-mfa-is-required"><span>OTP_MFA_IS_REQUIRED</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Enables OTP-based multi-factor authentication (MFA) for user sign-in. When set to true, users are required to configure OTP using an app like Google Authenticator during the sign-in process.</li></ul><h3 id="sms-mfa-is-required" tabindex="-1"><a class="header-anchor" href="#sms-mfa-is-required"><span>SMS_MFA_IS_REQUIRED</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Controls sms-based multi-factor authentication (MFA) for user sign-in. If set to true, users receive an MFA code via sms to confirm their login. <a href="#sms-functionality-setup">SMS functionality setup required</a></li></ul><h3 id="email-mfa-is-required" tabindex="-1"><a class="header-anchor" href="#email-mfa-is-required"><span>EMAIL_MFA_IS_REQUIRED</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Controls email-based multi-factor authentication (MFA) for user sign-in. If set to true, users receive an MFA code via email to confirm their login. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="enforce-one-mfa-enrollment" tabindex="-1"><a class="header-anchor" href="#enforce-one-mfa-enrollment"><span>ENFORCE_ONE_MFA_ENROLLMENT</span></a></h3><ul><li><strong>Default:</strong> [&#39;otp&#39;, &#39;email&#39;]</li><li><strong>Description:</strong> Enforce one MFA type from the list. Available options are ‘email’, ‘otp’, and ‘sms’. This setting is only effective if OTP_MFA_IS_REQUIRED, SMS_MFA_IS_REQUIRED, and EMAIL_MFA_IS_REQUIRED are all set to false. An empty list means no MFA type will be enforced. You must enable email functionality for the email MFA option to work. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="allow-email-mfa-as-backup" tabindex="-1"><a class="header-anchor" href="#allow-email-mfa-as-backup"><span>ALLOW_EMAIL_MFA_AS_BACKUP</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> This setting allows users to use email-based MFA as an alternative method for signing in if they are enrolled in OTP MFA and not enrolled in email MFA. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="account-lockout-threshold" tabindex="-1"><a class="header-anchor" href="#account-lockout-threshold"><span>ACCOUNT_LOCKOUT_THRESHOLD</span></a></h3><ul><li><strong>Default:</strong> 5</li><li><strong>Description:</strong> Number of failed login attempts before the user account is locked. Set to 0 to disable the account lockout feature.</li></ul><h3 id="account-lockout-expires-in" tabindex="-1"><a class="header-anchor" href="#account-lockout-expires-in"><span>ACCOUNT_LOCKOUT_EXPIRES_IN</span></a></h3><ul><li><strong>Default:</strong> 86400 (1 day)</li><li><strong>Description:</strong> Duration (in seconds) for which the account remains locked after reaching the lockout threshold. Set to 0 for indefinite lockout until manual intervention.</li></ul><h3 id="unlock-account-via-password-reset" tabindex="-1"><a class="header-anchor" href="#unlock-account-via-password-reset"><span>UNLOCK_ACCOUNT_VIA_PASSWORD_RESET</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> User can unlock their account by reset password. <a href="#email-functionality-setup">Email functionality setup required</a></li></ul><h3 id="supported-locales" tabindex="-1"><a class="header-anchor" href="#supported-locales"><span>SUPPORTED_LOCALES</span></a></h3><ul><li><strong>Default:</strong> [&#39;en&#39;, &#39;fr&#39;]</li><li><strong>Description:</strong> Specifies the locales supported for identity pages and emails.</li></ul><h3 id="enable-locale-selector" tabindex="-1"><a class="header-anchor" href="#enable-locale-selector"><span>ENABLE_LOCALE_SELECTOR</span></a></h3><ul><li><strong>Default:</strong> true</li><li><strong>Description:</strong> Determines whether users can switch to a different locale on identity pages. If only one locale is supported (<code>SUPPORTED_LOCALE</code>), the locale selector will be suppressed, regardless of this setting.</li></ul><h3 id="terms-link" tabindex="-1"><a class="header-anchor" href="#terms-link"><span>TERMS_LINK</span></a></h3><ul><li><strong>Default:</strong> &quot;&quot;</li><li><strong>Description:</strong> URL to display a link to your Terms of Service on the sign-up page.</li></ul><h3 id="privacy-policy-link" tabindex="-1"><a class="header-anchor" href="#privacy-policy-link"><span>PRIVACY_POLICY_LINK</span></a></h3><ul><li><strong>Default:</strong> &quot;&quot;</li><li><strong>Description:</strong> URL to display a link to your Privacy Policy on the sign-up page.</li></ul><h3 id="enable-email-log" tabindex="-1"><a class="header-anchor" href="#enable-email-log"><span>ENABLE_EMAIL_LOG</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Specify whether email should be logged. If enabled, ensure that you implement your own email log cleanup scheduler.</li></ul><h3 id="enable-sign-in-log" tabindex="-1"><a class="header-anchor" href="#enable-sign-in-log"><span>ENABLE_SIGN_IN_LOG</span></a></h3><ul><li><strong>Default:</strong> false</li><li><strong>Description:</strong> Specify whether the user’s sign-in IP (only applicable in production environments) and location details (only applicable in Cloudflare environments) should be logged. If enabled, ensure that you implement your own sign-in log cleanup scheduler, clearly disclose the collection of IP and location data in your privacy policy, and comply with all relevant legal requirements.</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: byn9826@gmail.com">Baozier</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DpbDqZoo.js" defer></script>
  </body>
</html>
